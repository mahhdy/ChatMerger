پردازش ترتیبی:
━━━━━━━━━━━━━━

⚠ PDF پیچیده‌ترین فرمت برای تبدیل است.
   کیفیت خروجی بستگی به نوع PDF دارد.

۱. تشخیص نوع PDF:
   - PDF متنی (text-based): بهترین کیفیت
   - PDF اسکن‌شده (image-based): نیاز به OCR
   - PDF ترکیبی: بخشی متن، بخشی تصویر
   - PDF از LaTeX: بهترین حالت (ساختار حفظ شده)

۲. استخراج متن:
   - ابزار اصلی: PyMuPDF (fitz) یا pdfplumber
   - ابزار جایگزین: pdftotext (poppler)
   - OCR: Tesseract + pytesseract (برای تصاویر)
     → با زبان فارسی: tesseract --oem 3 -l fas+eng

۳. بازسازی ساختار:
   - تشخیص عناوین (بر اساس اندازه فونت و بولد بودن)
   - تشخیص پاراگراف‌ها
   - تشخیص لیست‌ها
   - تشخیص جداول (با camelot یا tabula)
   - تشخیص فرمول‌ها (با Nougat یا Mathpix)
   - تشخیص تصاویر (استخراج embedded images)

۴. بازسازی فرمول‌ها:
   - ابزار ۱: Nougat (Meta) — مدل تخصصی PDF→LaTeX
   - ابزار ۲: Mathpix API — تبدیل تصویر فرمول → LaTeX
   - ابزار ۳: InftyReader
   - ابزار ۴: AI (GPT-4 Vision) — برای موارد پیچیده

۵. استخراج تصاویر:
   - PyMuPDF: page.get_images()
   - ذخیره با کیفیت اصلی
   - تعیین محل در متن

۶. پردازش RTL:
   - تشخیص جهت پاراگراف
   - اصلاح ترتیب کاراکترها (logical order vs visual order)
   - بازسازی نیم‌فاصله‌ها (ممکن است از دست رفته باشند)

۷. بررسی کیفیت:
   - مقایسه تعداد صفحات
   - مقایسه تعداد تصاویر
   - مقایسه تقریبی تعداد کلمات
   - امتیاز اطمینان (confidence score)

⚠ محدودیت‌ها:
   - فرمول‌های پیچیده ممکن است نادرست تبدیل شوند
   - جداول پیچیده ممکن است شکسته شوند
   - نیم‌فاصله‌ها ممکن است از دست رفته باشند
   - توصیه: PDF از LaTeX ← بهتر است فایل .tex اصلی تبدیل شود